# 営業自動化システム v2.0

## 📋 概要

**営業自動化システム（Sales Automation System）v2.0** は、商材起点で企業を発掘し、AI により提案を自動生成する営業プロセス自動化ツールです。

### 主要機能
- 🎯 **ChatGPT APIによるキーワード自動生成**
- 🔍 **Google検索による企業自動発掘**
- 📊 **マッチ度スコアリング（0-100点）**
- ✨ **AI による個別最適化提案生成**
- 📈 **総合レポート・活動ログ**
- 💰 **5段階料金プラン対応（¥500-¥7,500/月）**
- 🔐 **営業日ベースライセンス管理**
- 🔄 **プラン別メニュー・シート表示制御**

## 📁 ファイル構成

```
sales-automation-system/
├── README-日本語.md              # プロジェクト説明（日本語）
├── README.md                     # プロジェクト説明（英語）
├── SPEC_DRIVEN_RULES.md          # 仕様準拠開発ルール
├── src/                          # ソースコード
│   ├── main-menu.js              # 仕様書v2.0準拠メニューシステム
│   ├── user-manager.js           # ユーザー権限管理システム
│   ├── license-manager.js        # ライセンス管理システム
│   ├── properties-manager.js     # API設定管理
│   ├── keywords.js               # キーワード生成エンジン
│   ├── keywords-simple.js        # 簡易キーワード生成
│   ├── companies.js              # 企業検索・分析エンジン
│   ├── proposals.js              # 提案生成エンジン
│   ├── proposals-enhanced.js     # 拡張提案機能
│   ├── scoring.js                # マッチ度スコアリング
│   ├── workflow.js               # 全自動ワークフロー制御
│   ├── utils.js                  # ユーティリティ機能
│   ├── globals.js                # 共通定数・関数
│   ├── spreadsheet-config.js     # スプレッドシート設定
│   ├── response-analyzer.js      # API応答解析
│   └── appsscript.json          # GAS設定
├── docs/                        # 📚 ドキュメント（日本語）
│   ├── はじめに.md              # プロジェクト概要
│   ├── ユーザー権限管理システム設計書.md  # 権限システム設計
│   ├── specifications/          # 📋 仕様書類
│   │   ├── システム仕様書-v2.0.md    # 【正版】メインシステム仕様
│   │   ├── 技術仕様書-v2.0.md       # 技術詳細仕様
│   │   ├── API仕様書-v2.0.md        # API関連仕様
│   │   └── データ仕様書.md          # データ構造仕様
│   ├── user-guide/              # 👤 ユーザーガイド
│   │   └── 完全ユーザーマニュアル-v2.0.md
│   └── development/             # 🔧 開発・実装関連
│       └── システム修正計画書.md     # 料金プラン機能実装計画
└── archive/                     # 📦 アーカイブ
    └── old-docs/                # 古いドキュメント保管
└── archive/                     # 🗄️ アーカイブ
    ├── アップロードガイド.md
    ├── アップロード手順書.md
    └── メニュー・トラブルシューティング.md
```

## 🚀 クイックスタート

### 1. システム要件
- Google Apps Script (V8 Runtime)
- Google Spreadsheets
- ChatGPT API キー
- Google Custom Search API キー

### 2. セットアップ
1. Google Apps Script プロジェクト作成
2. `src/` フォルダのコードをアップロード
3. API キーを設定
4. システム初期化実行

### 3. 基本使用方法
1. 制御パネルで商材情報を設定
2. キーワード生成を実行
3. 企業検索を実行
4. 提案メッセージを生成
5. 結果を確認・活用

## 📖 ドキュメント

### 📋 仕様書
- **[システム仕様書 v2.0](docs/specifications/システム仕様書-v2.0.md)** - 全体システム設計
- **[技術仕様書 v2.0](docs/specifications/技術仕様書-v2.0.md)** - 技術実装詳細
- **[API仕様書 v2.0](docs/specifications/API仕様書-v2.0.md)** - 外部API連携
- **[データ仕様書](docs/specifications/データ仕様書.md)** - データ構造定義
- **[ユーザー権限管理システム設計書](docs/ユーザー権限管理システム設計書.md)** - 権限システム設計

### 💰 料金・プラン
- **[料金プラン詳細仕様書 v3.0](docs/料金プラン詳細仕様書-v3.0.md)** - 完全版料金体系
- **[料金プラン概要一覧](docs/料金プラン概要一覧.md)** - 簡潔版料金情報

### 💰 利用ガイド
- **[料金・API利用ガイド](docs/specifications/料金・API利用ガイド.md)** - 料金体系・API設定

### 👤 ユーザーガイド
- **[完全ユーザーマニュアル v2.0](docs/user-guide/完全ユーザーマニュアル-v2.0.md)** - 操作方法詳細

## ✅ 実装済み機能

- ✅ **キーワード自動生成**（ChatGPT API）
- ✅ **企業自動検索**（Google Custom Search API）
- ✅ **マッチ度スコアリング**（5要素評価）
- ✅ **提案メッセージ生成**（AI個別最適化）
- ✅ **総合レポート生成**（基本統計）
- ✅ **活動ログ管理**
- ✅ **将来機能一覧表示**（シート形式）
- ✅ **営業日ベースライセンス管理**

## 🚧 開発予定機能

### Phase 0（緊急実装）
- 📊 キーワード使用状況分析
- 📊 企業詳細分析
- 📊 提案効果分析
- 📈 マッチ度計算拡張

### Phase 1（短期：1-3ヶ月）
- 📝 キーワード編集機能
- ➕ 企業手動追加機能
- 📝 提案編集機能
- 💳 基本課金システム

### Phase 2+（中長期）
- 🔗 Gmail連携
- 👥 マルチユーザー対応
- 🌐 Webアプリ化
- 🔗 CRM統合

## 🛠️ 技術スタック

- **プラットフォーム**: Google Apps Script (V8)
- **データ管理**: Google Spreadsheets  
- **AI API**: OpenAI ChatGPT API
- **検索API**: Google Custom Search API
- **認証**: OAuth 2.0
- **言語**: JavaScript ES6+

## 📞 サポート

- **システムヘルプ**: メニュー「📚 ヘルプ・ドキュメント」
- **将来機能確認**: メニュー「🚀 将来機能一覧」
- **トラブルシューティング**: `archive/メニュー・トラブルシューティング.md`

## 📄 ライセンス

- **試用期間**: 10営業日（土日祝日除く）
- **管理者機能**: ライセンス期限管理・課金状況管理
- **継続利用**: 課金により無制限利用可能

---

*最終更新: 2025年10月17日*  
*バージョン: v2.0*  
*作成者: 営業自動化システム開発チーム*

## 概要

このシステムは、Google Apps Script (GAS) を使用して開発された営業プロセス自動化ツールです。漠然とした商材情報から戦略的な企業検索キーワードを生成し、Google検索による企業情報の自動収集・分析、各企業に最適化された提案メッセージの自動生成までを一貫して行います。

## 主な機能

### 1. キーワード自動生成
- ChatGPT APIを使用した戦略的検索キーワードの生成
- 4つのカテゴリ（課題発見、成長企業、予算企業、タイミング）別の最適化

### 2. 企業検索・分析
- Google Custom Search APIによる企業検索
- ウェブサイト情報の自動抽出・分析
- マッチ度スコアリング（0-100点）

### 3. 提案メッセージ生成
- 企業ごとに個別最適化された提案文の生成
- A/Bパターンの提案（課題訴求型・成功事例型）
- 問い合わせフォーム用短縮メッセージ

### 4. 全自動実行
- キーワード生成→企業検索→提案生成の一貫実行
- 進捗状況の可視化
- 詳細な実行ログと統計情報

## ファイル構成

```
sales-automation-system/
├── appsscript.json       # GASプロジェクト設定
├── main.gs              # メイン機能・シート初期化
├── keywords.gs          # キーワード生成機能
├── companies.gs         # 企業検索・分析機能
├── scoring.gs           # マッチ度スコア計算
├── proposals.gs         # 提案メッセージ生成
├── workflow.gs          # 全自動実行制御
├── utils.gs             # ユーティリティ機能
└── README.md           # このファイル
```

## セットアップ手順

### 1. Google Apps Scriptプロジェクトの作成

1. [Google Apps Script](https://script.google.com/) にアクセス
2. 「新しいプロジェクト」を作成
3. プロジェクト名を「営業自動化システム」に変更

### 2. ファイルのアップロード

各`.gs`ファイルの内容をGoogle Apps Scriptエディタにコピー：

1. `main.gs` → `Code.gs`（デフォルトファイルを置き換え）
2. 他の`.gs`ファイルを新規作成してコピー

### 3. APIキーの取得

#### Google Custom Search API
1. [Google Cloud Console](https://console.cloud.google.com/) でプロジェクト作成
2. Custom Search API を有効化
3. APIキーを作成
4. [Programmable Search Engine](https://programmablesearchengine.google.com/) でカスタム検索エンジンを作成

#### OpenAI API
1. [OpenAI Platform](https://platform.openai.com/) でアカウント作成
2. APIキーを生成

### 4. APIキーの設定

システム初期化後、メニューから「APIキー設定」を選択して設定

### 5. システムの初期化

1. スプレッドシートを新規作成
2. 拡張機能 → Apps Script でスクリプトエディタを開く
3. 関数一覧から `initializeSheets` を実行

## 使用方法

### 基本的な流れ

1. **制御パネルで設定**
   - 商材名、商材概要を入力
   - 価格帯、対象企業規模を選択
   - 検索企業数上限を設定

2. **実行方法を選択**
   - 「全自動実行」：全工程を一括実行
   - 個別実行：キーワード生成→企業検索→提案生成を段階的に実行

3. **結果の確認**
   - 各シートで結果を確認
   - ダッシュボードで統計情報を確認

### データシート

- **制御パネル**：設定値、実行ボタン、ダッシュボード
- **生成キーワード**：戦略的検索キーワード一覧
- **企業マスター**：発見された企業情報とスコア
- **提案メッセージ**：個別最適化された提案文
- **実行ログ**：処理履歴とエラー情報

## 技術仕様

### 外部API

- **OpenAI ChatGPT API (gpt-3.5-turbo)**
  - キーワード生成
  - 企業情報分析
  - 提案メッセージ作成

- **Google Custom Search API**
  - 企業ウェブサイト検索
  - 検索結果の取得

### スコアリングアルゴリズム

マッチ度スコア（0-100点）は以下の要素で算出：

- 企業規模適合性（±20点）
- 業界適合性（±15点）
- 問い合わせ方法（±10点）
- 成長性（±10点）
- 情報充実度（±5点）

### エラーハンドリング

- API制限対応（指数バックオフ）
- データ品質チェック
- 重複データの除去
- 詳細なエラーログ

## 制限事項

### API制限
- Google Custom Search API：100回/日（無料版）
- OpenAI API：トークン数による課金
- Google Apps Script：実行時間6分制限

### データ制限
- スプレッドシート：最大1,000万セル
- 1回の実行：最大20社程度推奨

## トラブルシューティング

### よくある問題

1. **APIキーエラー**
   - 設定値を確認
   - API有効化状況を確認

2. **実行時間超過**
   - 検索企業数上限を減らす
   - 段階的実行を使用

3. **検索結果が少ない**
   - キーワード戦略を見直し
   - 価格帯・企業規模設定を調整

### デバッグ機能

- `performHealthCheck()`：システム状態確認
- `executeWorkflowStep()`：段階的実行
- ログファイルでの詳細追跡

## カスタマイズ

### スコアリング調整

`scoring.gs`の`calculateMatchScore()`関数で重み付けを調整可能

### 業界適合性調整

`scoring.gs`の`industryFitMap`で業界別適合度を調整可能

### プロンプト調整

各機能の`createPrompt()`系関数でChatGPTへの指示を調整可能

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## サポート

システムに関する質問や改善要望がある場合は、開発チームまでお問い合わせください。

---

**重要事項**
- APIキーは適切に管理し、外部に漏洩しないよう注意してください
- 検索対象企業の利用規約を遵守してください
- 生成されたメッセージは内容を確認してから使用してください
