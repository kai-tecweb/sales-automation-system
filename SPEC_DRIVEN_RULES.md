# 📋 仕様書駆動開発ルール - 営業自動化システム

## 🎯 目的
システム仕様書v2.0からの逸脱を防ぎ、一貫性のある開発を維持するためのガバナンスルール

---

## 🛡️ 必須ガバナンスルール

### ルール1: メニュー変更の事前承認制
```
⚠️ 重要: メニュー構造の変更は事前に仕様書準拠チェックを実行すること
```

**実行手順:**
1. 変更前に `generateComplianceReport()` を実行
2. 仕様書との差異を確認
3. 差異がある場合は仕様書更新を検討
4. 承認後に変更実施

### ルール2: 新機能追加時の仕様書確認
```
❌ 仕様書に定義されていない機能の追加禁止
```

**確認事項:**
- [ ] 機能は仕様書v2.0に定義されているか？
- [ ] カテゴリは正しい位置か？
- [ ] 関数名は仕様書と一致するか？

### ルール3: 定期的な準拠性監査
```
📅 月1回の準拠性チェック実行
```

**監査内容:**
- メニュー構造の準拠性
- 実装済み機能の確認
- 欠落機能の特定

---

## 🔧 技術実装ルール

### ファイル構成ルール
```
src/
├── main-menu.js           ❌ 削除対象（複雑化したファイル）
├── menu-spec-compliant.js ✅ 仕様書準拠メニュー（標準）
├── spec-compliance.js     ✅ ガバナンス機能
└── [既存ファイル]          ✅ そのまま維持
```

### メニューシステム実装ルール

#### 1. 必須実装項目（仕様書v2.0準拠）
```javascript
// ✅ 必須カテゴリ（この順序で実装）
const REQUIRED_CATEGORIES = [
  '📊 システム管理',
  '🔍 キーワード管理', 
  '🏢 企業管理',
  '💼 提案管理',
  '📊 分析・レポート',
  '📚 ヘルプ・ドキュメント',
  '⚙️ 設定'
];
```

#### 2. 禁止事項
```javascript
// ❌ 禁止: 権限別メニュー分離
// ❌ 禁止: テスト機能のメインメニュー配置
// ❌ 禁止: 仕様書にない独自カテゴリ追加
```

#### 3. 管理者機能の追加ルール
```javascript
// ✅ 許可: 仕様書定義の管理者専用機能
const ADMIN_CATEGORIES = [
  '🔐 ライセンス管理（管理者専用）',
  '👥 ユーザー管理（管理者専用）', 
  '🔧 高度な設定（管理者専用）'
];
```

---

## 📋 チェックリスト

### 開発前チェック
- [ ] 仕様書v2.0を最新版で確認
- [ ] 実装予定機能が仕様書に定義されている
- [ ] 既存の準拠性に問題がない

### 開発中チェック
- [ ] メニュー構造が仕様書と一致
- [ ] 関数名が仕様書と一致
- [ ] カテゴリ分類が正確

### 開発後チェック
- [ ] `generateComplianceReport()` で準拠性確認
- [ ] 全機能の動作確認
- [ ] ドキュメント更新

---

## 🚨 違反対処法

### レベル1: 軽微な違反
**例:** 関数名の不一致、アイコンの相違
**対処:** 即座に修正

### レベル2: 中程度の違反  
**例:** カテゴリの追加・削除、機能の移動
**対処:** 仕様書更新検討 → 修正

### レベル3: 重大な違反
**例:** メニュー構造の根本的変更
**対処:** `enforceSpecCompliantMenu()` で強制復元

---

## 🔄 継続的改善プロセス

### 1. 月次レビュー
```bash
# 実行コマンド
generateComplianceReport()  # 準拠性確認
```

### 2. 仕様書更新プロセス
1. 現状分析
2. ステークホルダー協議  
3. 仕様書改訂
4. 実装更新

### 3. 開発者教育
- 仕様書駆動開発の重要性
- ガバナンス機能の使用方法
- 違反事例の共有

---

## ⚡ クイック復旧手順

### 問題: メニューが仕様書から大きく逸脱している
```javascript
// 🚨 緊急復旧
enforceSpecCompliantMenu();  // 仕様書準拠メニューに強制復元
```

### 問題: 準拠性が不明
```javascript
// 🔍 現状確認
generateComplianceReport();  // 詳細な準拠性レポート生成
```

### 問題: 機能が見つからない
```javascript
// 📋 機能確認  
showBasicInfo();  // システム基本情報と機能一覧表示
```

---

## 📚 関連ドキュメント

- `docs/specifications/システム仕様書-v2.0.md` - 基準仕様書
- `src/spec-compliance.js` - ガバナンス機能実装
- `src/menu-spec-compliant.js` - 準拠メニュー実装

---

## 🎯 成功指標

### 技術指標
- [ ] 仕様書準拠率 100%
- [ ] 未実装機能の明確な把握
- [ ] ガバナンス機能の正常動作

### 品質指標  
- [ ] メニュー構造の一貫性
- [ ] ユーザビリティの向上
- [ ] 開発効率の改善

### プロセス指標
- [ ] 月次監査の実行
- [ ] 違反発生率の低減
- [ ] 仕様書更新プロセスの確立