# 📋 営業自動化システム ヘルプページ作成指示書

## 🎯 作成するヘルプページの概要

**ページタイトル**: 「料金・API設定ガイド」  
**目的**: ユーザーがAPI料金体系を理解し、自分で設定できるようにする  
**対象ユーザー**: ITに詳しくない営業担当者でも理解できるレベル  
**実装場所**: メニュー「📚 ヘルプ・ドキュメント」→「💰 料金・API設定ガイド」

---

## 📊 作成してほしいページ構成

### 1. 製品ラインナップセクション
**見出し**: 🆓 基本版とAI強化版について

**含める内容**:
```markdown
## プラン選択

### 営業自動化システム 基本版
- **料金**: システム利用料のみ
- **制限**: 手動キーワード設定・テンプレート提案
- **機能**: 企業検索・基本分析・レポート
- **API**: Google Custom Search のみ

### 営業自動化システム AI強化版  
- **料金**: システム利用料 + API実費
- **制限**: なし
- **機能**: AI キーワード生成・個別最適化提案・詳細分析
- **API**: Google Custom Search + ChatGPT API
```

### 2. 料金概要セクション
**見出し**: 💰 営業自動化システム 利用料金について

**含める内容**:
```markdown
## 料金の仕組み

### 基本版
- システム利用料: [ライセンス料金]円（買い切り/月額）
- API利用料: 約0.1円/企業（Google Search のみ）
- **低コストで基本機能を永続利用可能**

### AI強化版
- システム利用料: [ライセンス料金]円（買い切り/月額）
- API利用料: 約2.5円/企業（Google Search + ChatGPT）
- **AI による高度な営業自動化**

## 料金内訳
- **Google Custom Search API**: 約0.1円/企業検索
- **ChatGPT API**: 約2.4円/企業（キーワード生成 + 提案生成）
- **システム利用料**: ライセンス管理・機能提供
```

### 3. 料金シミュレーションセクション
**見出し**: 📈 どのくらいの料金になる？

**含める内容**:
```markdown
| プラン | 処理企業数/日 | API料金/日 | API料金/月 | 想定用途 |
|--------|---------------|-------------|-------------|----------|
| **基本版** | 50社 | **5円** | **150円** | 個人営業・スタートアップ |
| **基本版** | 100社 | **10円** | **300円** | 小規模営業チーム |
| AI強化版 | 50社 | 125円 | 3,750円 | 個人営業（AI活用） |
| AI強化版 | 100社 | 250円 | 7,500円 | 営業チーム（AI活用） |
| AI強化版 | 500社 | 1,250円 | 37,500円 | 大規模営業組織 |

## 💡 コスト最適化のヒント
- **段階的導入**: 基本版で検証→AI強化版へアップグレード
- **バッチ処理**: まとめて実行でAPI効率化
- **設定最適化**: 企業数上限設定で予算管理
```

### 4. 無料枠・お試し利用セクション
**見出し**: 🎁 お得に始められます！

**含める内容**:
```markdown
## Google Custom Search 無料枠
- **100回/日**: 毎日100企業まで無料検索
- **月3,000回**: 基本版なら月額コスト大幅削減

## ChatGPT API 初回クレジット
- **$5無料クレジット**: 新規アカウント特典
- **約2-4週間**: 初期は低コストでAI機能試用可能
- **段階的利用**: 効果確認後に本格運用

## システム試用期間
- **10営業日**: ライセンス管理による試用期間
- **全機能利用**: 期間中は制限なし
- **延長可能**: 管理者認証で期間延長
```

### 5. API設定手順セクション
**見出し**: ⚙️ API設定の手順

**含める内容**:
```markdown
## Google Custom Search API 設定

### 1. Google Cloud Console での設定
1. [Google Cloud Console](https://console.cloud.google.com/) にアクセス
2. 新しいプロジェクトを作成
3. Custom Search API を有効化
4. 認証情報でAPIキーを作成

### 2. カスタム検索エンジン設定
1. [Custom Search Engine](https://cse.google.com/) にアクセス
2. 新しい検索エンジンを作成
3. 検索対象: 「ウェブ全体を検索」を選択
4. 検索エンジンIDをコピー

### 3. システムへの設定
1. スプレッドシートの「制御パネル」を開く
2. 「Google Search API Key」にAPIキーを入力
3. 「Search Engine ID」に検索エンジンIDを入力

## ChatGPT API 設定（AI強化版）

### 1. OpenAI アカウント作成
1. [OpenAI Platform](https://platform.openai.com/) にアクセス
2. アカウント作成・電話番号認証
3. 支払い方法設定（$5無料クレジット適用）

### 2. APIキー取得
1. API Keys ページでシークレットキー作成
2. キーをコピー（再表示不可のため注意）

### 3. システムへの設定
1. 制御パネルの「ChatGPT API Key」に入力
2. 🧪 システムテストで動作確認
```

### 6. 使用量監視・予算管理セクション
**見出し**: 📊 使用量の監視と予算管理

**含める内容**:
```markdown
## 使用量確認方法

### Google API 使用量
1. [Google Cloud Console](https://console.cloud.google.com/) → APIs & Services → Usage
2. Custom Search API の使用量グラフを確認
3. アラート設定で上限通知

### ChatGPT API 使用量
1. [OpenAI Usage](https://platform.openai.com/usage) ページを確認
2. リアルタイム使用量・月次統計を表示
3. 使用量制限設定でコスト管理

### システム内監視
- **📋 活動ログ**: 実行履歴・API使用回数確認
- **📊 総合レポート**: 月次使用統計・コスト概算
- **⚙️ 設定**: 企業数上限・バッチサイズで予算制御

## 予算管理のベストプラクティス
1. **段階的スケールアップ**: 小規模テスト→本格運用
2. **使用量アラート**: 予算の80%で通知設定
3. **定期レビュー**: 月次でROI分析・コスト最適化
```

### 7. よくある質問セクション
**見出し**: ❓ 料金・設定に関するよくある質問

**含める内容**:
```markdown
## API料金について

**Q: 料金はいつ発生しますか？**
A: APIを実際に使用した分のみ発生します。システムを起動しただけでは料金は発生しません。

**Q: 月の途中で上限を超えたらどうなりますか？**
A: Google APIは無料枠超過後に従量課金、ChatGPT APIは残高不足でエラーになります。

**Q: 基本版から AI強化版への変更は可能ですか？**
A: はい。ChatGPT API キーを設定するだけで AI機能が有効になります。

## 設定トラブル

**Q: APIキーを設定したのにエラーが出ます**
A: 🧪 システムテストで詳細エラーを確認してください。多くの場合、API有効化待ちです。

**Q: 検索結果が取得できません**
A: カスタム検索エンジンの設定で「ウェブ全体を検索」が選択されているか確認してください。

**Q: ChatGPT APIの残高確認方法は？**
A: OpenAI Platform の Usage ページで現在の残高・使用量を確認できます。

## 最適化について

**Q: コストを下げる方法はありますか？**
A: 企業数上限設定、基本版での試用、バッチ処理の活用が効果的です。

**Q: どのプランがおすすめですか？**
A: 最初は基本版で業務フローを確認し、効果が実感できたら AI強化版への移行をお勧めします。
```

---

## 🎨 UI実装要件

### メニュー統合
```javascript
// menu.js への追加
.addItem('💰 料金・API設定ガイド', 'showPricingGuide')
```

### 関数実装
```javascript
function showPricingGuide() {
  try {
    const ui = SpreadsheetApp.getUi();
    let guideText = '💰 料金・API設定ガイド\n\n';
    
    guideText += '📋 プラン選択:\n';
    guideText += '• 基本版: Google検索のみ（約0.1円/企業）\n';
    guideText += '• AI強化版: AI生成機能付き（約2.5円/企業）\n\n';
    
    guideText += '🎁 お得情報:\n';
    guideText += '• Google無料枠: 100回/日まで無料\n';
    guideText += '• ChatGPT初回: $5無料クレジット\n';
    guideText += '• システム試用: 10営業日無料\n\n';
    
    guideText += '⚙️ 設定方法:\n';
    guideText += '1. 制御パネルでAPI キー設定\n';
    guideText += '2. 🧪 システムテストで動作確認\n';
    guideText += '3. 企業数上限で予算管理\n\n';
    
    guideText += '詳細は「📖 ユーザーガイド」をご確認ください。';
    
    ui.alert(guideText);
  } catch (error) {
    console.error('Show pricing guide error:', error);
    SpreadsheetApp.getUi().alert('❌ ガイド表示エラー: ' + String(error).substring(0, 100));
  }
}
```

---

## 📋 実装チェックリスト

### Phase 1: 基本実装
- [ ] メニュー項目追加（💰 料金・API設定ガイド）
- [ ] 基本ガイド関数実装
- [ ] 既存ヘルプメニューとの統合

### Phase 2: 詳細コンテンツ
- [ ] プラン比較表示機能
- [ ] 料金シミュレーター（簡易版）
- [ ] API設定手順ガイド

### Phase 3: 高度機能
- [ ] 使用量監視ダッシュボード
- [ ] コスト計算機能
- [ ] 予算アラート機能

---

## 💡 実装時の注意点

1. **既存システムとの整合性**: 現在の機能名・UI表記と統一
2. **段階的実装**: まず基本ガイド→詳細機能の順で実装
3. **ユーザビリティ**: 非技術者でも理解できる説明
4. **保守性**: 料金変更時の更新しやすさを考慮

---

*最終更新: 2025年10月17日*  
*営業自動化システム v2.0 対応*
