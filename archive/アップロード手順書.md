# Google Apps Scriptへのアップロード手順

## 方法1: 手動アップロード（推奨・簡単）

### 1. Google Apps Scriptプロジェクトの作成
1. https://script.google.com/ にアクセス
2. Googleアカウントでログイン
3. 「新しいプロジェクト」をクリック
4. プロジェクト名を「営業自動化システム」に変更

### 2. ファイルのアップロード
以下の順序でファイルをアップロードしてください：

#### a) メインファイル（Code.gs）の置き換え
1. 既存の`Code.gs`を選択
2. 内容を削除
3. `main.gs`の内容をコピー＆ペースト
4. Ctrl+S で保存

#### b) 追加ファイルの作成
各ファイルを新規作成：

1. **keywords.gs**
   - 「ファイル」→「新規」→「スクリプト」
   - ファイル名を`keywords`に変更
   - `keywords.gs`の内容をコピー＆ペースト

2. **companies.gs**
   - 「ファイル」→「新規」→「スクリプト」
   - ファイル名を`companies`に変更
   - `companies.gs`の内容をコピー＆ペースト

3. **scoring.gs**
   - 「ファイル」→「新規」→「スクリプト」
   - ファイル名を`scoring`に変更
   - `scoring.gs`の内容をコピー＆ペースト

4. **proposals.gs**
   - 「ファイル」→「新規」→「スクリプト」
   - ファイル名を`proposals`に変更
   - `proposals.gs`の内容をコピー＆ペースト

5. **workflow.gs**
   - 「ファイル」→「新規」→「スクリプト」
   - ファイル名を`workflow`に変更
   - `workflow.gs`の内容をコピー＆ペースト

6. **utils.gs**
   - 「ファイル」→「新規」→「スクリプト」
   - ファイル名を`utils`に変更
   - `utils.gs`の内容をコピー＆ペースト

### 3. 設定ファイルの適用
1. プロジェクト設定（歯車アイコン）をクリック
2. 「appsscript.json」タブを選択
3. 「マニフェストファイルをエディタで表示する」をチェック
4. `appsscript.json`の内容で置き換え

## 方法2: CLIツール（clasp）を使用したアップロード

### 前提条件
- Node.jsとnpmがインストールされていること
- Googleアカウントでの認証が必要

### 手順

1. **claspの認証**
```bash
cd /home/iwasaki/sales-automation-system
npx @google/clasp login
```

2. **新しいプロジェクトの作成**
```bash
npx @google/clasp create --title "営業自動化システム" --type standalone
```

3. **ファイルのアップロード**
```bash
npx @google/clasp push
```

### ファイル管理の注意点
- `.claspignore`ファイルを作成して、不要なファイルをアップロード対象から除外
- `README.md`や`docs/`フォルダはアップロード不要

## アップロード後の設定

### 1. APIキーの設定
1. システム初期化後、メニューから「APIキー設定」を選択
2. 以下のAPIキーを設定：
   - OpenAI APIキー
   - Google Custom Search APIキー
   - カスタム検索エンジンID

### 2. 必要なAPI有効化
1. Google Cloud Console (https://console.cloud.google.com/)
2. Custom Search API を有効化
3. Programmable Search Engine (https://programmablesearchengine.google.com/) でカスタム検索エンジンを作成

### 3. スプレッドシートでの実行
1. 新しいGoogleスプレッドシートを作成
2. 拡張機能 → Apps Script でスクリプトエディタを開く
3. 作成したプロジェクトを選択またはコピー
4. `initializeSheets`関数を実行してシステムを初期化

## トラブルシューティング

### よくある問題
1. **権限エラー**: Googleアカウントでの認証が必要
2. **実行時間制限**: GASの6分制限に注意
3. **APIキーエラー**: 正しいAPIキーが設定されているか確認

### 確認ポイント
- すべての`.gs`ファイルがアップロードされているか
- `appsscript.json`が正しく設定されているか
- 必要なAPIが有効化されているか
