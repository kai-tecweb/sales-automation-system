# メニュー表示問題 - 解決ガイド

## 問題の原因
1. **複数のonOpen関数の競合**: `menu.gs`, `menu-simple.gs`, `menu-minimal.gs` に複数の `onOpen()` 関数が存在
2. **Google Apps Scriptの制限**: 1つのプロジェクトでは最後に読み込まれた `onOpen()` 関数のみが有効

## 実施した修正

### 1. 競合するonOpen関数の無効化
- `menu-simple.gs` と `menu-minimal.gs` の `onOpen()` 関数を `onOpen_disabled()` に変更
- これにより `menu.gs` の `onOpen()` 関数のみが有効になる

### 2. メインメニューの改良 (`menu.gs`)
- より確実なエラーハンドリングを追加
- 複数段階のフォールバック機能を実装
- システム診断機能を追加

### 3. バックアップメニューの作成 (`menu-backup.gs`)
- 緊急時用の最小限メニューを準備
- 手動実行可能な復旧機能を提供

## 使用方法

### 通常時
スプレッドシートを開くと「営業自動化システム」メニューが自動表示されます。

### メニューが表示されない場合の対処法

#### 方法1: 手動でメニュー再作成
1. Apps Script エディタを開く
2. `menu.gs` の `recreateMenu()` 関数を実行

#### 方法2: システム診断の実行
1. Apps Script エディタを開く
2. `menu.gs` の `systemDiagnostic()` 関数を実行
3. 診断結果を確認

#### 方法3: バックアップメニューの使用
1. Apps Script エディタを開く
2. `menu-backup.gs` の `activateBackupMenu()` 関数を実行
3. 「営業システム（緊急）」メニューから復旧を試行

### 各メニュー項目の機能
- **企業情報登録**: 企業データの登録
- **提案書作成**: 提案書の自動生成
- **ヘルプ**: システムの使用方法
- **テスト実行**: 動作確認
- **管理者モード**: 管理機能へのアクセス
- **システム状態**: 各機能の動作状況確認
- **メニュー再作成**: メニューの手動再生成

## トラブルシューティング

### ログの確認方法
1. Apps Script エディタの「実行」メニューから「ログを表示」
2. `console.log` の出力を確認

### 権限エラーの場合
1. Apps Script の実行権限を確認
2. 必要に応じて権限を再承認

### エラーが継続する場合
1. スプレッドシートを一度閉じて再度開く
2. ブラウザのキャッシュをクリア
3. 別のブラウザで試行

## 今後の注意点
- 複数の `onOpen()` 関数を作成しない
- メニュー関連の変更時は競合を避ける
- 定期的にバックアップを取る
